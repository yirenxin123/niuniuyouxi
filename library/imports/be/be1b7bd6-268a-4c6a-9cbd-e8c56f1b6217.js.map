{
  "version": 3,
  "sources": [
    "unknown"
  ],
  "names": [
    "HttpRequest",
    "urls",
    "game",
    "HttpEvent",
    "NO_NETWORK",
    "UNKNOWN_ERROR",
    "http",
    "module",
    "exports",
    "get",
    "url",
    "completeCallback",
    "errorCallback",
    "sendRequest",
    "getByArraybuffer",
    "getWithParams",
    "params",
    "getWithParamsByArraybuffer",
    "callback",
    "post",
    "_getParamString",
    "result",
    "name",
    "format",
    "substr",
    "length",
    "isPost",
    "responseType",
    "newUrl",
    "cc",
    "warn",
    "xhr",
    "loader",
    "getXMLHttpRequest",
    "open",
    "setRequestHeader",
    "onerror",
    "readyState",
    "status",
    "onreadystatechange",
    "response",
    "responseText",
    "send",
    "JSON",
    "stringify"
  ],
  "mappings": "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",
  "file": "unknown",
  "sourcesContent": [
    "/** \r\n * 游戏服务器管理\r\n * Author      : donggang\r\n * Create Time : 2016.8.19\r\n */\r\nvar HttpRequest = {};\r\nvar urls        = {};           // 当前请求地址集合\r\n\r\ngame.HttpEvent = {};\r\ngame.HttpEvent.NO_NETWORK    = \"http_request_no_network\";               // 断网\r\ngame.HttpEvent.UNKNOWN_ERROR = \"http_request_unknown_error\";            // 未知错误\r\n\r\ngame.http = module.exports = {\r\n    /**\r\n     * HTTP GET请求\r\n     * 例：\r\n     * \r\n     * Get\r\n        var url = \"http://httpbin.org/get?show_env=1\";\r\n        var complete = function(response){\r\n               \r\n            cc.log(response);\r\n        }\r\n        var error = function(response){\r\n            cc.log(response);\r\n        }\r\n        game.HttpRequest.get(url, complete, error);\r\n    */\r\n    get : function(url, completeCallback, errorCallback){\r\n        game.http.sendRequest(url, null, false, completeCallback, errorCallback)\r\n    },\r\n\r\n    getByArraybuffer : function(url, completeCallback, errorCallback){\r\n        game.http.sendRequest(url, null, false, completeCallback, errorCallback, 'arraybuffer');\r\n    },\r\n\r\n    getWithParams : function(url, params, completeCallback, errorCallback){\r\n        game.http.sendRequest(url, params, false, completeCallback, errorCallback)\r\n    },\r\n\r\n    getWithParamsByArraybuffer : function(url, params, callback, errorCallback){\r\n        game.http.sendRequest(url, params, false, completeCallback, errorCallback, 'arraybuffer');\r\n    },\r\n\r\n    /** \r\n     * HTTP POST请求\r\n     * 例：\r\n     *      \r\n     * Post\r\n        var url = \"http://192.168.1.188/api/LoginNew/Login1\";\r\n        var param = '{\"LoginCode\":\"donggang_dev\",\"Password\":\"e10adc3949ba59abbe56e057f20f883e\"}'\r\n        var complete = function(response){\r\n                var jsonData = JSON.parse(response);\r\n                var data = JSON.parse(jsonData.Data);\r\n            cc.log(data.Id);\r\n        }\r\n        var error = function(response){\r\n            cc.log(response);\r\n        }\r\n        game.HttpRequest.post(url, param, complete, error);\r\n    */\r\n    post : function(url, params, completeCallback, errorCallback){\r\n        game.http.sendRequest(url, params, true, completeCallback, errorCallback);\r\n    },\r\n\r\n    /**\r\n     * 获得字符串形式的参数\r\n     */\r\n    _getParamString : function(params){\r\n        var result = \"\";\r\n        for(var name in params){\r\n            result += \"{0}={1}&\".format(name, params[name]);\r\n        }\r\n\r\n        return result.substr(0, result.length - 1);\r\n    },\r\n\r\n\r\n    /** \r\n     * Http请求 \r\n     * @param url(string)               请求地址\r\n     * @param params(JSON)              请求参数\r\n     * @param isPost(boolen)            是否为POST方式\r\n     * @param callback(function)        请求成功回调\r\n     * @param errorCallback(function)   请求失败回调\r\n     * @param responseType(string)      响应类型\r\n     */\r\n    sendRequest : function(url, params, isPost, completeCallback, errorCallback, responseType){\r\n        if (url == null || url == '')\r\n            return;\r\n\r\n        var newUrl;\r\n        if (params) {\r\n            newUrl = url + \"?\" + this._getParamString(params);\r\n        }\r\n        else {\r\n            newUrl = url;\r\n        }\r\n\r\n        if (urls[newUrl] != null){\r\n            cc.warn(\"地址【{0}】已正在请求中，不能重复请求\".format(url));\r\n            return;\r\n        }\r\n\r\n        // 防重复请求功能\r\n        urls[newUrl] = true;\r\n\r\n        var xhr = cc.loader.getXMLHttpRequest();\r\n        if (isPost){\r\n            xhr.open(\"POST\", url);\r\n        }\r\n        else {\r\n            xhr.open(\"GET\", newUrl);\r\n        }\r\n\r\n        xhr.setRequestHeader(\"Content-Type\", \"application/x-www-form-urlencoded\");\r\n\r\n        xhr.onerror = function() {\r\n            delete urls[newUrl];\r\n            if (errorCallback == null) return;\r\n            if (xhr.readyState == 1 && xhr.status == 0){\r\n                errorCallback(game.HttpEvent.NO_NETWORK);               // 断网\r\n            }\r\n            else{\r\n                errorCallback(game.HttpEvent.UNKNOWN_ERROR);            // 未知错误\r\n            }\r\n        };\r\n\r\n        xhr.onreadystatechange = function() {\r\n            if (xhr.readyState != 4) return;\r\n\r\n            delete urls[newUrl];\r\n            if (xhr.status == 200){\r\n                if(completeCallback) {\r\n                    if (responseType == 'arraybuffer') { \r\n                        xhr.responseType = responseType;\r\n                        completeCallback(xhr.response);                 // 加载非文本格式\r\n                    } \r\n                    else {\r\n                        completeCallback(xhr.responseText);             // 加载文本格式\r\n                    }                    \r\n                }                    \r\n            } \r\n            else {\r\n                if(errorCallback) errorCallback(xhr.status);\r\n            }\r\n        };\r\n\r\n        if (params == null || params == \"\"){\r\n            xhr.send();\r\n        }\r\n        else {\r\n            xhr.send(JSON.stringify(params));\r\n        }\r\n    }\r\n}"
  ]
}