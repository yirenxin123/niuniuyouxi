{
  "version": 3,
  "sources": [
    "unknown"
  ],
  "names": [
    "BasePop",
    "require",
    "MessageFactory",
    "MusicMgr",
    "Audio_Common",
    "GameSystem",
    "cc",
    "Class",
    "extends",
    "properties",
    "MessageDetailView",
    "Prefab",
    "ScrollView",
    "NoticeMsgCell",
    "Node",
    "NoticeRedTip",
    "NoticeNum",
    "Label",
    "ClubMsgCell",
    "ClubMsgRedTip",
    "ClubMsgNum",
    "SitReqCell",
    "onLoad",
    "_super",
    "createMessageReq",
    "US_REQ_NEW_MSG_NUM_CMD_ID",
    "send",
    "initBaseData",
    "CellNum",
    "onMessage",
    "event",
    "log",
    "msg",
    "data",
    "cmd",
    "US_RESP_NEW_MSG_NUM_CMD_ID",
    "onNewMsg",
    "US_RESP_MSG_LIST_CMD_ID",
    "onMsgList",
    "US_RESP_OWNER_CONFIRM_CMD_ID",
    "onOwnerConfirm",
    "code",
    "SocketRetCode",
    "RET_SUCCESS",
    "dismiss",
    "type",
    "cellCount",
    "content",
    "getChildrenCount",
    "list",
    "undefined",
    "cellHeight",
    "index",
    "length",
    "json",
    "BASE64",
    "decoder",
    "JSON",
    "parse",
    "instantiate",
    "addChild",
    "getContentSize",
    "height",
    "setPosition",
    "p",
    "getComponent",
    "setMessageInfo",
    "sysnum",
    "active",
    "string",
    "clubnum",
    "start",
    "total",
    "US_REQ_MSG_LIST_CMD_ID",
    "callbackBtn",
    "CustomEventData",
    "btnName",
    "target",
    "getName",
    "playEffect",
    "AUDIO_BTN_CLICK",
    "node",
    "sendGetMsgList"
  ],
  "mappings": "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",
  "file": "unknown",
  "sourcesContent": [
    "var BasePop = require('BasePop');\r\nvar MessageFactory = require('MessageFactory');\r\nvar MusicMgr = require('MusicMgr');\r\nvar Audio_Common = require('Audio_Common');\r\nvar GameSystem = require(\"GameSystem\");\r\n\r\ncc.Class({\r\n    extends: BasePop,\r\n\r\n    properties: {\r\n        MessageDetailView : cc.Prefab,\r\n        ScrollView        : cc.ScrollView,\r\n        NoticeMsgCell     : cc.Node,\r\n        NoticeRedTip      : cc.Node,\r\n        NoticeNum         : cc.Label,\r\n        ClubMsgCell       : cc.Node,\r\n        ClubMsgRedTip     : cc.Node,\r\n        ClubMsgNum        : cc.Label,\r\n        SitReqCell        : cc.Prefab,\r\n    },\r\n\r\n    // use this for initialization\r\n    onLoad: function () {\r\n        this._super();\r\n        MessageFactory.createMessageReq(US_REQ_NEW_MSG_NUM_CMD_ID).send();\r\n        this.initBaseData();\r\n    },\r\n\r\n    initBaseData : function () {\r\n        this.CellNum = 0;\r\n    },\r\n\r\n    /*********************Network***************************/\r\n    onMessage : function (event) {\r\n        cc.log(\"MessageView.onMessage\");\r\n        //this._super(event);\r\n        var msg = event.data;\r\n        var cmd = msg.cmd;\r\n        switch (cmd) {\r\n            case US_RESP_NEW_MSG_NUM_CMD_ID:\r\n                this.onNewMsg(msg);\r\n                break;\r\n\r\n            case US_RESP_MSG_LIST_CMD_ID:\r\n                this.onMsgList(msg);\r\n                break;\r\n\r\n            case US_RESP_OWNER_CONFIRM_CMD_ID:\r\n                this.onOwnerConfirm(msg);\r\n                break;\r\n        }\r\n    },\r\n\r\n    onOwnerConfirm : function (msg) {\r\n        if (msg.code < SocketRetCode.RET_SUCCESS) {\r\n            cc.log(\"MessageView.onOwnerConfirm\");\r\n            this.dismiss();\r\n        } else {\r\n\r\n        }\r\n    },\r\n\r\n    onMsgList : function (msg) {\r\n        if(msg.code == SocketRetCode.RET_SUCCESS) {\r\n            if(msg.type == 1) {\r\n\r\n            }\r\n            else if(msg.type == 2) {\r\n\r\n            }\r\n            else if(msg.type == 3) {\r\n                var cellCount = this.ScrollView.content.getChildrenCount();\r\n                if(msg.list == null || msg.list == undefined)\r\n                    return ;\r\n                let cellHeight = 0;\r\n                for(var index = 0; index < msg.list.length; index++) {\r\n                    var json = BASE64.decoder(msg.list[index].msg);\r\n                    msg.list[index].msg = JSON.parse(json);\r\n                    cc.log(\"MessageView.onMsgList,json = \" + msg.list[index].msg);\r\n\r\n                    var SitReqCell = cc.instantiate(this.SitReqCell);\r\n                    this.ScrollView.content.addChild(SitReqCell);\r\n                    cellHeight = SitReqCell.getContentSize().height;\r\n                    SitReqCell.setPosition(cc.p(0, -SitReqCell.getContentSize().height*(cellCount + index + 1)));\r\n                    SitReqCell.getComponent(\"SitReqCell\").setMessageInfo(msg.list[index], msg.type);\r\n                }\r\n\r\n                if (cellHeight * (this.ScrollView.content.getChildrenCount() + 1) > this.ScrollView.content.height) {\r\n                    this.ScrollView.content.height = cellHeight * (this.ScrollView.content.getChildrenCount() + 1);\r\n                }\r\n            }\r\n\r\n        }\r\n    },\r\n    \r\n    onNewMsg : function (msg) {\r\n        if(msg.code == SocketRetCode.RET_SUCCESS)\r\n        {\r\n            if(msg.sysnum > 0)\r\n            {\r\n                this.NoticeRedTip.active = true;\r\n                this.NoticeNum.string    = msg.sysnum;\r\n                this.CellNum++;\r\n            }\r\n\r\n            if(msg.clubnum > 0)\r\n            {\r\n                this.ClubMsgRedTip.active = true;\r\n                this.ClubMsgNum.string    = msg.clubnum;\r\n                this.CellNum++;\r\n            }\r\n\r\n            var data = {\r\n                type : 3,\r\n                start : 0,\r\n                total : 50,\r\n            };\r\n            MessageFactory.createMessageReq(US_REQ_MSG_LIST_CMD_ID).send(data);\r\n        }\r\n    },\r\n    \r\n    callbackBtn : function(event,CustomEventData) {\r\n        cc.log(\"MessageView.callbackBtn,CustomEventData = \" + CustomEventData);\r\n        var btnName = event.target.getName();\r\n        cc.log(\"MessageView.callbackBtn,btnName = \" + btnName);\r\n        MusicMgr.playEffect(Audio_Common.AUDIO_BTN_CLICK);\r\n\r\n        if(btnName == \"BtnClose\") {\r\n            this.dismiss();\r\n        }\r\n        else if(btnName == \"NoticeMsgCell\") {\r\n            var MessageDetailView = cc.instantiate(this.MessageDetailView);\r\n            this.node.addChild(MessageDetailView);\r\n            MessageDetailView.setPosition(cc.p(0,0));\r\n            MessageDetailView.getComponent('MessageDetailView').sendGetMsgList(1);\r\n        }\r\n        else if(btnName == \"ClubMsgCell\") {\r\n            cc.log(\"MessageView.ClubMsgCell\");\r\n            var MessageDetailView = cc.instantiate(this.MessageDetailView);\r\n            this.node.addChild(MessageDetailView);\r\n            MessageDetailView.setPosition(cc.p(0,0));\r\n            MessageDetailView.getComponent('MessageDetailView').sendGetMsgList(2);\r\n        }\r\n    },\r\n});\r\n"
  ]
}