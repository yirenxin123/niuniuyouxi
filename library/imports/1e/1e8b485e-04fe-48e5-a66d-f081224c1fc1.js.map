{
  "version": 3,
  "sources": [
    "unknown"
  ],
  "names": [
    "BasePop",
    "require",
    "MessageFactory",
    "MusicMgr",
    "Audio_Common",
    "GameSystem",
    "cc",
    "Class",
    "extends",
    "properties",
    "scrollView",
    "ScrollView",
    "MessageCell",
    "Prefab",
    "MessageCellDetailView",
    "SitReqCell",
    "onLoad",
    "_super",
    "type",
    "onMessage",
    "event",
    "log",
    "msg",
    "data",
    "cmd",
    "US_RESP_MSG_LIST_CMD_ID",
    "onGetMessageList",
    "CLUB_RESP_OWNER_CONFIRM_CMD_ID",
    "sendGetMsgList",
    "start",
    "total",
    "createMessageReq",
    "US_REQ_MSG_LIST_CMD_ID",
    "send",
    "code",
    "SocketRetCode",
    "RET_SUCCESS",
    "list",
    "undefined",
    "cellHeight",
    "content",
    "removeAllChildren",
    "index",
    "length",
    "json",
    "BASE64",
    "decoder",
    "instantiate",
    "addChild",
    "getContentSize",
    "height",
    "setPosition",
    "p",
    "getComponent",
    "setMessageCellMsg",
    "self",
    "on",
    "Node",
    "EventType",
    "TOUCH_END",
    "target",
    "createMessageCellDetailView",
    "bind",
    "JSON",
    "parse",
    "setMessageInfo",
    "node",
    "setContent",
    "callbackBtn",
    "CustomEventData",
    "btnName",
    "getName",
    "playEffect",
    "AUDIO_BTN_CLICK",
    "dismiss"
  ],
  "mappings": "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",
  "file": "unknown",
  "sourcesContent": [
    "var BasePop = require('BasePop');\r\nvar MessageFactory = require('MessageFactory');\r\nvar MusicMgr = require('MusicMgr');\r\nvar Audio_Common = require('Audio_Common');\r\nvar GameSystem = require(\"GameSystem\");\r\n\r\ncc.Class({\r\n    extends: BasePop,\r\n\r\n    properties: {\r\n        scrollView : cc.ScrollView,\r\n        MessageCell : cc.Prefab,\r\n        MessageCellDetailView : cc.Prefab,\r\n        SitReqCell : cc.Prefab,\r\n    },\r\n\r\n    // use this for initialization\r\n    onLoad: function () {\r\n        this._super();\r\n        this.type = 0;\r\n    },\r\n\r\n    /*********************Network***************************/\r\n\r\n    onMessage : function (event) {\r\n        cc.log(\"MessageDetailView.onMessage\");\r\n        //this._super(event);\r\n        var msg = event.data;\r\n        var cmd = msg.cmd;\r\n        switch (cmd) {\r\n            case US_RESP_MSG_LIST_CMD_ID:\r\n                this.onGetMessageList(msg);\r\n                break;\r\n\r\n            case CLUB_RESP_OWNER_CONFIRM_CMD_ID:\r\n                cc.log(\"MessageDetailView.onMessage CLUB_RESP_OWNER_CONFIRM_CMD_ID\");\r\n                break;\r\n        }\r\n    },\r\n\r\n    sendGetMsgList : function (type) {\r\n        this.type = type;\r\n        var data = {\r\n            type : type,\r\n            start : 0,\r\n            total : 50,\r\n        };\r\n        MessageFactory.createMessageReq(US_REQ_MSG_LIST_CMD_ID).send(data);\r\n    },\r\n    \r\n    onGetMessageList : function (msg)\r\n    {\r\n        if (msg.code != SocketRetCode.RET_SUCCESS) {\r\n            return;\r\n        }\r\n\r\n        if (msg.list == null || msg.list == undefined) {\r\n            return;\r\n        }\r\n\r\n        if (msg.type == 1) { //系统消息\r\n            let cellHeight = 0;\r\n            this.scrollView.content.removeAllChildren(true);\r\n\r\n            for(var index = 0; index < msg.list.length;index++) {\r\n                var json = BASE64.decoder(msg.list[index].msg);\r\n                cc.log(\"MessageDetailView.onMsgList,json = \" + json);\r\n                var MessageCell = cc.instantiate(this.MessageCell);\r\n                this.scrollView.content.addChild(MessageCell);\r\n                cellHeight = MessageCell.getContentSize().height;\r\n                MessageCell.setPosition(cc.p(0,- MessageCell.getContentSize().height*(index + 0.5)));\r\n                MessageCell.getComponent('MessageCell').setMessageCellMsg(msg.list[index]);\r\n                var self = this;\r\n                MessageCell.on(cc.Node.EventType.TOUCH_END, function(event){\r\n                    var msg = event.target.getComponent('MessageCell').msg;\r\n                    self.createMessageCellDetailView(msg);\r\n\r\n                }.bind(this));\r\n            }\r\n\r\n            if (cellHeight*msg.list.length > this.scrollView.content.height) {\r\n                this.scrollView.content.height = cellHeight *msg.list.length\r\n            }\r\n        } else if(msg.type == 2) { //俱乐部消息\r\n\r\n            this.scrollView.content.removeAllChildren(true);\r\n            let cellHeight = 0;\r\n\r\n            for (var index = 0; index < msg.list.length; index++)\r\n            {\r\n                var json = BASE64.decoder(msg.list[index].msg);\r\n                msg.list[index].msg = JSON.parse(json);\r\n                cc.log(\"MessageView.onMsgList,msg.list[index].msg = \", msg.list[index].msg);\r\n\r\n                var SitReqCell = cc.instantiate(this.SitReqCell);\r\n                this.scrollView.content.addChild(SitReqCell);\r\n                cellHeight = SitReqCell.getContentSize().height;\r\n                SitReqCell.setPosition(cc.p(0,- SitReqCell.getContentSize().height * (index + 1)));\r\n                SitReqCell.getComponent(\"SitReqCell\").setMessageInfo(msg.list[index], 2);\r\n            }\r\n            if(cellHeight * (msg.list.length + 1) > this.scrollView.content.height)\r\n            {\r\n                this.scrollView.content.height = cellHeight * (msg.list.length + 1);\r\n            }\r\n        }\r\n\r\n    },\r\n\r\n    createMessageCellDetailView : function (msg) {\r\n        var MessageCellDetailView = cc.instantiate(this.MessageCellDetailView);\r\n        this.node.addChild(MessageCellDetailView);\r\n        MessageCellDetailView.setPosition(cc.p(0,0));\r\n        MessageCellDetailView.getComponent('MessageCellDetailView').setContent(msg);\r\n    },\r\n\r\n    callbackBtn : function(event,CustomEventData)\r\n    {\r\n        cc.log(\"MessageDetailView.callbackBtn,CustomEventData = \" + CustomEventData);\r\n        var btnName = event.target.getName();\r\n        cc.log(\"MessageDetailView.callbackBtn,btnName = \" + btnName);\r\n        MusicMgr.playEffect(Audio_Common.AUDIO_BTN_CLICK);\r\n        if(btnName == \"BtnClose\") {\r\n            this.dismiss();\r\n        }\r\n    },\r\n    \r\n});\r\n"
  ]
}